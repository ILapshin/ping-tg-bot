# Ping Telegram Bot Service
Сервис позволяет опрашивать сайты из заданного списка на предмет доступности.


Сервис опрашивает сайты автоматически с заданной периодичностью и совершает рассылку в телеграм-боте для пользователей, подписанных на рассылку. 
Подписка на рассылку осуществляется вызовом команды ```/start``` в бота.


Также сервис предоставляет функцию ручного запроса от пользователя по кнопке в телеграм-боте.

## Запуск сервиса

### Запуск из командной строки

1. Создать в корневой папке клонированного репозитория файл ```.env``` со следующими переменными среды:

```
BOT_TOKEN=[Ваш токен телеграм-бота]
USERS_FILE_PATH=[Путь к файлу хранения подписчиков]             # например, USERS_FILE_PATH=./users.txt
URL_LIST=[Список хостов для проверки, разделенный запятой]      # например, URL_LIST=github.com,google.com,nohost.net
TIME_OFFSET=[Периодичность автоматической проверки в минутах]   # в минутах
```

2. Создать и активировать виртуальную среду:
```
python3 -m venv .venv
source .venv/bin/activate
```

3. Установить зависимости:
```
pip3 install -r requirements.txt
```

4. Запустить сервис:
```
python3 src/main.py
```

### Запуск в контейнере Docker

1. Собрать контейнер:
```
docker build -t ping-tg-bot .
```

2. Создать том для хранения данных о пользователях:
```
docker volume create tgbot-storage
```

3. Запустить контейнер, передав в команде переменные среды в качестве параметров:
```
docker run -v tgbot-storage:/code -e "BOT_TOKEN=[Ваш токен телеграм-бота]" -e "USERS_FILE_PATH=[Путь к файлу хранения подписчиков]" -e "URL_LIST=[Список хостов для проверки, разделенный запятой]" -e "TIME_OFFSET=[Периодичность автоматической проверки в минутах]" ping-tg-bot 
```